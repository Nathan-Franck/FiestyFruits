<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Fruit Frenzy</title>
  <link rel="stylesheet" href="css/style.css" />
  <script>
    var global = {};
  </script>
  <script src="/socket.io/socket.io.js"></script>
  <script src="js/jquery-1.10.2.min.js"></script>
  <script src="js/pixi.js"></script>
  <script src="js/Unit.js"></script>
  <script src="js/Game.js"></script>
  <script src="js/Player.js"></script>
  <script src="js/Time.js"></script>
  <script src="js/Point.js"></script>
  <script src="js/Graphics.js"></script>
</head>

<body>
	<h1>Fiesty Fruits</h1>
  <script>
    var socket = io.connect('http://localhost:1337');
    Graphics.init();
    requestAnimFrame(animate);
    function animate() {
      requestAnimFrame(animate);
      Game.update();
      Graphics.update();
    }
    socket.on('update', function(data) {
      Unit.enlist(new Unit(data));
      console.log("The unit's x pos: " + Unit.list[data.id].position.x);
    });
    socket.on('updateGoal', function(data) {
      var i;
      for (i = 0; i < Unit.list.length; ++i) {
        if ( Unit.list[i] != null ) {
          Unit.list[i].goal.x = data.x;
          Unit.list[i].goal.y = data.y;
        }
      }      
    })

    $(window).mousedown(function(e) {
      var i;
      for (i = 0; i < Unit.list.length; ++i) {
        if ( Unit.list[i] != null ) {
          Unit.list[i].goal.x = e.pageX;
          Unit.list[i].goal.y = e.pageY;
          socket.emit('update', Unit.list[i].goal);          
        }
      }
    });
  </script>
</body>
</html>
